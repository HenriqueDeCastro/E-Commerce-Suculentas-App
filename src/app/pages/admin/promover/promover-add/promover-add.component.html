<ng-container *ngIf="!Roles">
  <app-spinner></app-spinner>
</ng-container>
<ng-container *ngIf="Roles">
  <app-voltar></app-voltar>
  <br>
  <br>
  <br>
  <h1 class="titulo">Nova promoção</h1>
  <br>
  <mat-vertical-stepper [linear]="true" #stepper>
  <mat-step [stepControl]="UserForm">
    <ng-template matStepLabel>Usuário</ng-template>
    <br>
    <form [formGroup]="UserForm" (ngSubmit)="ProcurarUsuario()" autocomplete="off">
      <mat-form-field appearance="fill" class="w-100">
        <mat-label> E-mail </mat-label>
        <input matInput formControlName="user">
        <mat-icon class="material-icons-outlined" matSuffix>alternate_email</mat-icon>
        <mat-error *ngIf="UserForm.get('user').hasError('email')" class="invalid-feedback">Insira apenas e-mails validos</mat-error>
        <mat-error *ngIf="UserForm.get('user').hasError('required')" class="invalid-feedback">E-mail é obrigatório</mat-error>
      </mat-form-field>
      <ng-container *ngIf="!User">
        <br>
        <br>
        <ng-container *ngIf="Pesquisando">
          <app-progressbar></app-progressbar>
          <br>
        </ng-container>
        <button mat-flat-button class="w-100" color="primary" [disabled]=Pesquisando>Pesquisar</button>
      </ng-container>
      <ng-container *ngIf="User">
        <br>
        <mat-form-field appearance="fill" class="w-100">
          <mat-label> Nome </mat-label>
          <input matInput [value]=User.fullName [disabled]=true>
          <mat-icon class="material-icons-outlined" matSuffix>person</mat-icon>
        </mat-form-field>
        <br>
        <mat-form-field appearance="fill" class="w-100">
          <mat-label> CPF </mat-label>
          <input matInput [value]=User.cpf [disabled]=true>
          <mat-icon class="material-icons-outlined" matSuffix>person</mat-icon>
        </mat-form-field>
        <br>
        <button mat-button class="w-100" color="accent" (click)="AlterarUser()">Alterar</button>
      </ng-container>
      <br>
      <br>
      <div class="form-group col-md-12 centralizar">
        <button mat-button matStepperNext class="w-50" color="primary" [disabled]="!User">Próximo</button>
      </div>
    </form>
  </mat-step>
  <mat-step [stepControl]="RoleForm">
    <ng-template matStepLabel>Função</ng-template>
    <br>
    <form [formGroup]="RoleForm" (ngSubmit)="Promover()" autocomplete="off">
      <mat-form-field appearance="fill" class="w-100">
        <mat-label>Funções</mat-label>
        <mat-select formControlName="roles">
          <mat-option *ngFor="let role of Roles" [value]="role.name">
            {{role.name}}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="RoleForm.get('roles').hasError('required')" class="invalid-feedback">Função é obrigatória</mat-error>
      </mat-form-field>
      <br>
      <br>
      <ng-container *ngIf="RealizandoCadastro">
        <app-progressbar></app-progressbar>
      </ng-container>
      <br>
      <div class="form-group col-md-12 centralizar">
        <button mat-button matStepperPrevious class="w-50" color="warn">Anterior</button>
        <button mat-button matStepperNext class="w-50" color="primary" [disabled]="RealizandoCadastro">Finalizar</button>
      </div>
    </form>
  </mat-step>
  </mat-vertical-stepper>
</ng-container>
